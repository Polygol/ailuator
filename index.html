<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
   <title>Ailuator</title>
   <link rel="icon" href="favicon.png" type="image/png">
   <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
   <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,700,1,0" />
   <script src="/assets/gurapp/api/gurasuraisu-api.js" defer></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
   <style>
        :root {
            --edge-refraction-filter: url('#edge-refraction-only');
           --sun-shadow: 0 0 0 0 transparent;
           
            /* Dark Theme (Default) Variables */
            --background-color-dark: #1c1c1c;
            --background-color-dark-tr: rgba(28, 28, 28, 0.7);
            --text-color-dark: #f9f9f9;
            --secondary-text-color-dark: rgba(255, 255, 255, 0.7);
            --modal-background-dark: rgba(51, 51, 51, 0.8);
            --modal-transparent-dark: rgba(51, 51, 51, 0.7);
            --search-background-dark: rgba(51, 51, 51, 0.5);
            --dark-overlay: rgba(51, 51, 51, 0.2);
            --dark-transparent: rgba(255, 255, 255, 0.1); 
            --glass-border-dark: rgba(100, 100, 100, 0.2);
            
            /* Light Theme Variables */
            --background-color-light: #f0f0f0;
            --background-color-light-tr: rgba(240, 240, 240, 0.7);
            --text-color-light: #333333;
            --secondary-text-color-light: rgba(0, 0, 0, 0.7);
            --modal-background-light: rgba(220, 220, 220, 0.8);
            --modal-transparent-light: rgba(240, 240, 240, 0.7);
            --search-background-light: rgba(220, 220, 220, 0.5);
            --light-overlay: rgba(220, 220, 220, 0.2);
            --light-transparent: rgba(255, 255, 255, 0.1);
            --glass-border-light: rgba(200, 200, 200, 0.2);
            
            /* Default to Dark Theme */
            --background-color: var(--background-color-dark);
            --background-color-tr: var(--background-color-dark-tr);
            --text-color: var(--text-color-dark);
            --secondary-text-color: var(--secondary-text-color-dark);
            --modal-background: var(--modal-background-dark);
            --modal-transparent: var(--modal-transparent-dark);
            --search-background: var(--search-background-dark);
            --overlay-color: var(--dark-overlay);
            --transparent-color: var(--dark-transparent);
            --glass-border: var(--glass-border-dark);
        }
        
        body.light-theme {
            --background-color: var(--background-color-light);
            --background-color-tr: var(--background-color-light-tr);
            --text-color: var(--text-color-light);
            --secondary-text-color: var(--secondary-text-color-light);
            --modal-background: var(--modal-background-light);
            --modal-transparent: var(--modal-transparent-light);
            --search-background: var(--search-background-light);
            --overlay-color: var(--light-overlay);
            --transparent-color: var(--light-transparent);
            --glass-border: var(--glass-border-light);
        }
      
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
         font-variant-numeric: tabular-nums;
      }
      
      body {
          background-color: var(--background-color-tr);
          height: 100vh;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          user-select: none;
          transition: background-color 0.3s, color 0.3s;
          color: var(--text-color);
      }

      body::-webkit-scrollbar, .modal-content::-webkit-scrollbar {
            width: 8px; /* Thin scrollbar */
        }

        body::-webkit-scrollbar-track, .modal-content::-webkit-scrollbar-track {
            background: transparent;
        }

        body::-webkit-scrollbar-thumb, .modal-content::-webkit-scrollbar-thumb {
            background-color: var(--search-background);
            border-radius: 50px;
        }
      
      .calculator {
          width: 100%;
          height: 100%;
          padding: 40px;
          display: flex;
          flex-direction: column;
      }
      
      #toggle-numpad {
          width: 100%;
          padding: 15px;
          background-color: var(--search-background);
          color: var(--text-color);
          border: none;
          border-radius: 25px;
          margin-bottom: 20px;
          cursor: pointer;
          display: none;
          backdrop-filter: var(--edge-refraction-filter) saturate(2) blur(2.5px);
         box-shadow: var(--sun-shadow);
          border: 1px solid var(--glass-border);
      }
      
      .numpad {
          display: grid;
          grid-template-columns: repeat(4, 1fr);
          gap: 10px;
          height: 70%;
          width: 100%;
      }
      
      .control {
          background-color: var(--secondary-text-color);
          color: var(--background-color);
          grid-column: span 2;
          border-radius: 50px;
          corner-shape: superellipse(1.5);
      }
      
      .numpad.hidden {
          display: none;
      }
      
      button {
          padding: 15px;
          font-size: 1.2rem;
          border: none;
          cursor: pointer;
          background-color: var(--search-background);
          color: var(--text-color);
          transition: background-color 0.2s;
          backdrop-filter: var(--edge-refraction-filter) saturate(2) blur(2.5px);
          border-radius: 50px;
          corner-shape: superellipse(1.5);
          box-shadow: var(--sun-shadow);
          transform: scale(1);
          transition: all 0.15s cubic-bezier(0.2, 0, 0.38, 0.9);
         border: 1px solid var(--glass-border);
      }
      
      button:active {
          transform: scale(0.96);
          transition: all 0.1s cubic-bezier(0.2, 0, 0.38, 0.9);
          filter: brightness(1.5);
      }
      
      .operation {
          background-color: var(--secondary-text-color);
          color: var(--background-color);
          border-radius: 50px;
          corner-shape: superellipse(1.5);
      }
      
      .display-container {
          width: 100%;
          margin-bottom: 20px;
          border-radius: 25px;
          overflow: hidden;
          padding: 15px 20px;
          display: flex;
          flex-direction: column;
          height: calc(40% - 80px - 20px); /* 40% minus padding and margin */
          min-height: 120px;
      }
      
      #equation-view {
          width: 100%;
          height: 20px;
          background-color: transparent;
          color: var(--secondary-text-color);
          font-size: 0.9rem;
          text-align: right;
          padding: 0;
          border: none;
          outline: none;
      }
      
      #preview {
          width: 100%;
          height: 20px;
          background-color: transparent;
          color: var(--text-color);
          font-size: 0.9rem;
          text-align: right;
          padding: 0;
          border: none;
          outline: none;
      }
      
      #display {
          width: 100%;
          flex: 1;
          background-color: transparent;
          border: none;
          color: var(--text-color);
          font-size: 2rem;
          text-align: right;
          padding: 0;
          outline: none;
          margin-top: auto;
      }

      @media (max-width: 550px) {
         .calculator {
            padding: 20px;
         }
      }
      
      /* When animations are disabled */
      .reduce-animations * {
          /* Disable all animations */
          animation: none !important;
      
          /* Disable all transitions except opacity */
          transition: opacity 0.3s ease !important;
          transition-property: opacity !important;
      }
      
      /* Special handling for clickable elements */
      .reduce-animations button,
      .reduce-animations #toggle-numpad {
          /* Keep initial state but remove transition */
          transform: scale(1) !important;
          transition: opacity 0.3s ease !important;
      }
      
      /* Keep active state functional but without animation */
      .reduce-animations button:active,
      .reduce-animations #toggle-numpad:active {
          /* Apply scale instantly without transition */
          transform: scale(0.98) !important;
          transition: none !important;
          filter: brightness(1.5) !important;
      }
   </style>
</head>
<body data-app-name="AILUATOR">
    <svg style="display: none">
        <filter id="edge-refraction-only" color-interpolation-filters="linearRGB">
            <!-- Part 1: Create the turbulence noise that will displace the pixels -->
            <feTurbulence type="fractalNoise" baseFrequency="0.01 0.04" numOctaves="2" result="turbulence"></feTurbulence>
        
            <!-- Part 2: Create a mask that is only opaque at the very edges of the source graphic -->
            <feMorphology in="SourceGraphic" operator="erode" radius="4" result="eroded"></feMorphology>
            <feComposite in="SourceGraphic" in2="eroded" operator="out" result="border_mask"></feComposite>
        
            <!-- Part 3: Apply the turbulence only to the edge mask -->
            <feComposite in="turbulence" in2="border_mask" operator="in" result="edge_turbulence"></feComposite>
        
            <!-- Part 4: Create the full edge refraction effect -->
            <!-- Pass 1: A positive scale refracts the top and left edges. -->
            <feDisplacementMap result="disp_positive" yChannelSelector="G" xChannelSelector="R" scale="15" in2="edge_turbulence" in="SourceGraphic"></feDisplacementMap>
            <!-- Pass 2: A negative scale refracts the bottom and right edges. -->
            <feDisplacementMap in="SourceGraphic" in2="edge_turbulence" scale="-15" xChannelSelector="R" yChannelSelector="G" result="disp_negative"></feDisplacementMap>
            <!-- Blend the two passes to get the complete refraction effect. -->
            <feBlend in="disp_positive" in2="disp_negative" mode="lighten" result="refraction_effect"></feBlend>
    
            <!-- Part 5: Create the non-displaced center graphic -->
            <feDisplacementMap in="SourceGraphic" in2="edge_turbulence" scale="0" xChannelSelector="R" yChannelSelector="G" result="centered_graphic"></feDisplacementMap>
            
            <!-- Part 6: Create a mask for the center, leaving a 20px border -->
            <!-- Start with a solid rectangle -->
            <feFlood flood-color="white" result="full_rect"></feFlood>
            <!-- Erode it by 20px to create the inset center mask -->
            <feMorphology in="full_rect" operator="erode" radius="10" result="center_mask"></feMorphology>
            
            <!-- Part 7: Combine the two effects using the mask -->
            <!-- Keep the refracted effect only where it is *outside* the center mask (i.e., the border) -->
            <feComposite in="refraction_effect" in2="center_mask" operator="out" result="border_part"></feComposite>
            <!-- Keep the centered graphic only where it is *inside* the center mask -->
            <feComposite result="center_part" operator="in" in2="center_mask" in="centered_graphic"></feComposite>
            
            <!-- Part 8: Merge the final border and center parts together -->
            <feMerge result="final_image">
                <feMergeNode in="border_part"></feMergeNode>
                <feMergeNode in="center_part"></feMergeNode>
            </feMerge>
    
            <!-- Part 9: Adjust final opacity -->
            <feComponentTransfer in="final_image" result="final_output">
                <feFuncA type="linear" slope="0.95"></feFuncA>
            </feComponentTransfer>
        </filter>
    </svg>
   
   <div class="calculator">
       <div class="display-container">
           <input type="text" id="equation-view" readonly>
           <input type="text" id="preview" readonly>
           <input type="text" id="display" readonly>
       </div>
      <div class="numpad">
           <button class="control">AC</button>
           <button class="control">⌫</button>
           <button>7</button>
           <button>8</button>
           <button>9</button>
           <button class="operation">÷</button>
           <button>4</button>
           <button>5</button>
           <button>6</button>
           <button class="operation">×</button>
           <button>1</button>
           <button>2</button>
           <button>3</button>
           <button class="operation">-</button>
           <button>0</button>
           <button>.</button>
           <button class="operation">=</button>
           <button class="operation">+</button>
       </div>
   </div>

   <script>
       const equationView = document.getElementById('equation-view');
       const preview = document.getElementById('preview');
       const display = document.getElementById('display');
       const numpad = document.querySelector('.numpad');
       let expression = '';

       function calculatePreview(expr) {
           try {
               const calcExpr = expr.replace('×', '*').replace('÷', '/');
               const result = eval(calcExpr);
               return result;
           } catch {
               return '';
           }
       }

       document.addEventListener('keydown', (e) => {
           const key = e.key;
           if (/[0-9.]/.test(key) || ['+', '-', '*', '/', 'Enter', 'Backspace'].includes(key)) {
               e.preventDefault();
               handleInput(key);
           }
       });

       document.querySelectorAll('.numpad button').forEach(button => {
           button.addEventListener('click', () => {
               const value = button.textContent;
               handleInput(value);
           });
       });

       function handleInput(value) {
           switch(value) {
               case 'Enter':
               case '=':
                   try {
                       expression = expression.replace('×', '*').replace('÷', '/');
                       const result = eval(expression);
                       equationView.value = expression.replace('*', '×').replace('/', '÷') + ' =';
                       display.value = result;
                       preview.value = '';
                       expression = result.toString();
                   } catch {
                       display.value = 'Error';
                       preview.value = '';
                       equationView.value = '';
                       expression = '';
                   }
                   break;
               case 'AC':
                   expression = '';
                   display.value = '';
                   preview.value = '';
                   equationView.value = '';
                   break;
               case '⌫':
               case 'Backspace':
                   expression = expression.slice(0, -1);
                   display.value = expression;
                   preview.value = calculatePreview(expression);
                   equationView.value = '';
                   break;
               case '*':
                   expression += '×';
                   display.value = expression;
                   preview.value = calculatePreview(expression);
                   equationView.value = '';
                   break;
               case '/':
                   expression += '÷';
                   display.value = expression;
                   preview.value = calculatePreview(expression);
                   equationView.value = '';
                   break;
               default:
                   expression += value;
                   display.value = expression;
                   preview.value = calculatePreview(expression);
                   equationView.value = '';
           }
       }
   </script>
</body>
</html>
